CREATE TABLE t0( TEXT, c1, c2, c3, c4 TEXT);
SELECT subq1. c5 c6 FROM( SELECT FALSE c5 FROM( SELECT t1. c3 c6, c2 c7 FROM t0 t1 WHERE t1. c1 ORDER BY c7) subq0 JOIN t0 t2 ON( subq0. c6= t2. c3 AND subq0. c6) WHERE TRUE ORDER BY c5) subq1 WHERE CASE WHEN NULLIF( c5, c5)= CASE subq1. c5 WHEN subq1. c5 THEN subq1. c5 WHEN TRUE THEN subq1. c5 END THEN subq1. c5 END ORDER BY c6 COLLATE RTRIM DESC, c6, c6, c6 COLLATE NOCASE ASC;
;